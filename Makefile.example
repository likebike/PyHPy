# Adjust this Makefile to suit your server and project requirements.

PROJ_ROOT=${HOME}/mysite

# The MakoFW location:
MAKOFW_DIR=${PROJ_ROOT}/makofw

# The "source" files:
SRC_DIR=${PROJ_ROOT}/src

# The publication locations:
WWW_DEV=${PROJ_ROOT}/www/dev
WWW_PROD=${PROJ_ROOT}/www/prod

# The python binary to use:
PYTHON=python2.7
export PYTHONPATH:=${MAKOFW_DIR}/lib/python:${PYTHONPATH}


# By default, publish to the development site:
dev:
	${PYTHON} ${MAKOFW_DIR}/bin/publish.py "${SRC_DIR}" "${WWW_DEV}"

# Publish to the development site without doing as many ACL checks:
fast:
	ACL_CHECK=0 ${PYTHON} ${MAKOFW_DIR}/bin/publish.py "${SRC_DIR}" "${WWW_DEV}"

# Publish to the production site:
prod:
	${PYTHON} ${MAKOFW_DIR}/bin/publish.py "${SRC_DIR}" "${WWW_PROD}"

# Touch some critical files that force the whole site to be rebuilt:
touch:
	touch ${SRC_DIR}/_master.tmpl


